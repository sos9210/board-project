<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org"
      layout:decorate="~{fragment/layout}">

<div layout:fragment="content" class="container">
    <div class="bs-docs-section">
        <div class="row">
            <div class="col-lg-12">
                <div class="page-header">
                    <h1 id="typography" th:text="${view.subject}">제목</h1>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="bs-component" th:text="${view.content}">
            </div>
            <div class="input-group mb-3" th:if="${view.attachFile != null}">
                <div class="form-control" placeholder="Recipient's username" aria-label="Recipient's username" aria-describedby="downButton" th:text="${view.attachFile.realFileName}"></div>
                <a href="./download" th:href="@{/board/user/forum/download(attachFileSn=${view.attachFile.attachFileSn},boardSn=${view.boardSn})}" class="btn btn-primary" type="button" id="downButton">다운로드</a>
            </div>
        </div>
        <div class="bs-component mb-3">
            <div class="btn-group" role="group" aria-label="Basic example">
                <a href="/board/user/forums" class="btn btn-secondary">목록</a>
                <a type="button" href="#;" th:href="@{/board/user/forum/edit/{boardSn}(boardSn=${view.boardSn})}" th:if="${#strings.equals(#authentication.name,view.memberId)}" class="btn btn-secondary">수정</a>
                <button type="button" th:if="${#strings.equals(#authentication.name,view.memberId)}" id="boardDeleteBtn" class="btn btn-secondary">삭제</button>
            </div>
        </div>
        <form name="commentForm" th:action="@{/board/user/forum/comment/{boardSn}(boardSn=${view.boardSn})}" method="POST">
        <div class="form-group col-lg-6">
            <div class="input-group mb-3">
                <input type="text" class="form-control" placeholder="댓글내용을 입력하세요" aria-label="Recipient's username" aria-describedby="button-addon1">
                <button class="btn btn-primary" type="button" id="button-addon1">댓글등록</button>
            </div>
        </div>
        </form>
    </div>
    <div class="bs-docs-section">
        <div class="row">
            <div class="col-lg-12">
                <div class="page-header">
                    <h3 id="tables">댓글</h3>
                </div>

                <div class="bs-component">
                    <table class="table table-hover">
                        <tbody>
                        <tr class="table-active">
                            <td>Column content</td>
                            <td>Column content</td>
                            <td>2021-02-12 <span class="badge bg-primary">수정</span><span class="badge bg-danger">삭제</span></td>
                            <div class="input-group mb-3">
                                <input type="text" class="form-control" placeholder="수정내용을 입력하세요" aria-label="Recipient's username" aria-describedby="button-addon2">
                                <button class="btn btn-primary" type="button" id="button-addon2">댓글수정</button>
                            </div>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</html>
<script th:inline="javascript">
    var deleteBtn = document.getElementById("boardDeleteBtn");
    deleteBtn.addEventListener("click", () => {
        if(confirm("정말 삭제하시겠습니까? ")){
            //XMLHttpRequest 객체 생성
            var xhr = new XMLHttpRequest();

            //요청을 보낼 방식, url, 비동기여부 설정
            xhr.open('DELETE', '/board/user/forum/[[${view.boardSn}]]', true);

            //요청 전송
            xhr.send();

            //Callback
            xhr.onload = () => {
                if (xhr.status == 200) {
                    //success
                    alert(xhr.response);
                    location.href = "/board/user/forums";
                } else {
                    alert(xhr.response);
                }
            }
        }
    });
</script>